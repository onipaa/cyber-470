Sure, I'll provide you with a step-by-step guide to install Security Onion on Ubuntu 22.04 and configure Suricata to monitor and alert on access to `http://10.0.0.141/secure`.

### Step 1: Prepare Your System
Ensure your Ubuntu system is up-to-date.
```bash
sudo apt update
sudo apt upgrade -y
```

### Step 2: Install Security Onion
1. **Add the Security Onion repository and install its GPG key:**
    ```bash
    sudo apt install gnupg2 curl
    curl -o /usr/share/keyrings/securityonion.gpg https://packages.securityonion.net/securityonion.gpg
    echo "deb [signed-by=/usr/share/keyrings/securityonion.gpg] https://packages.securityonion.net/repo focal main" | sudo tee /etc/apt/sources.list.d/securityonion.list
    ```

2. **Update the package list and install Security Onion:**
    ```bash
    sudo apt update
    sudo apt install securityonion -y
    ```

3. **Run the Security Onion setup:**
    ```bash
    sudo so-setup
    ```
    Follow the prompts to configure Security Onion. Select the appropriate options for your deployment type.

### Step 3: Configure Suricata
1. **Locate the Suricata configuration directory:**
    ```bash
    cd /opt/so/saltstack/local/salt/suricata/
    ```

2. **Create a custom Suricata rule file:**
    ```bash
    sudo vim /etc/nsm/rules/local.rules
    ```
    Add the following rule to alert on access to `http://10.0.0.141/secure`:
    ```plain
    alert http any any -> 10.0.0.141 80 (msg:"Access to /secure detected"; uri_content:"/secure"; sid:1000001; rev:1;)
    ```

3. **Verify and reload Suricata rules:**
    ```bash
    sudo suricata-update
    sudo so-rule-update
    sudo so-sensor-restart
    ```

### Step 4: Verify Suricata is Running
1. **Check the status of Suricata:**
    ```bash
    sudo so-status
    ```

2. **Test the rule by accessing `http://10.0.0.141/secure` from a different machine on the network and checking if alerts are generated.**

### Step 5: Monitoring and Alerting
1. **Access Security Onion's web interface (Kibana) to monitor alerts:**
    Open a web browser and navigate to the Security Onion web interface using the IP address or hostname of your Security Onion server.

2. **Log in and go to the "Alerts" section to view any alerts generated by Suricata.**

### Additional Notes
- Ensure the firewall allows traffic on necessary ports for Security Onion and Suricata.
- Regularly update Suricata rules and Security Onion components.
- Fine-tune your rules and configurations as needed to reduce false positives and improve detection accuracy.

This should set up Security Onion with Suricata to alert on access to `http://10.0.0.141/secure`. Let me know if you need any further assistance!
